<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
          content="Thank you for subscribing to SwingPuzzles!"
          data-i18n-meta="success.meta.description">
    <title data-i18n="success.title">Thank you! - SwingPuzzles</title>
    <link rel="icon" type="image/png" href="favicon-48x48.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="success-page">
    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-inner">
            <div class="hero-mascot">
                <img src="mascot.webp" alt="SwingPuzzles mascot" data-i18n-attr-alt="hero.mascotAlt">
            </div>
            <h1 data-i18n="success.heading">Thank you!</h1>
            <p data-i18n="success.message">
                Check your inbox to confirm your subscription. We'll send you your first fact & puzzle soon!
            </p>

            <!-- NOVÉ CTA TLAČIDLO -->
            <a id="open-inbox-btn" class="cta-button" href="#" style="display:none">
                <span id="inbox-icon" class="inbox-icon"></span>
                <span id="inbox-text"></span>
            </a>

            <p class="hero-note">
                If you don't see the email, check your Spam or Promotions folder.
            </p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <a id="privacy-link" href="#" data-i18n="footer.privacy">Privacy Policy</a>
            <div class="footer-note">© SwingPuzzles</div>
        </div>
    </footer>
    
    <script>
        // Get parameters from URL first, fallback to sessionStorage if Vite redirect lost them
        let params = new URLSearchParams(window.location.search);
        let lang = params.get("lang");
        let provider = params.get("provider");
        
        // If parameters are missing (Vite redirect issue), restore from sessionStorage
        if (!lang || !provider) {
            try {
                const stored = sessionStorage.getItem('successParams');
                if (stored) {
                    const storedParams = JSON.parse(stored);
                    if (!lang) lang = storedParams.lang;
                    if (!provider) provider = storedParams.provider;
                    
                    // Restore URL parameters
                    const newParams = new URLSearchParams(window.location.search);
                    if (lang && !newParams.has('lang')) newParams.set('lang', lang);
                    if (provider && !newParams.has('provider')) newParams.set('provider', provider);
                    
                    // Update URL without page reload
                    const newUrl = window.location.pathname + (newParams.toString() ? '?' + newParams.toString() : '');
                    window.history.replaceState({}, '', newUrl);
                    
                    // Clean up sessionStorage
                    sessionStorage.removeItem('successParams');
                }
            } catch (e) {
                console.error('Error restoring parameters from sessionStorage:', e);
            }
        }

        // --- PRIVACY LINK ---
        const privacyLink = document.getElementById("privacy-link");
        privacyLink.href = lang
            ? `https://swingpuzzles.com/privacy-policy?lang=${lang}`
            : "https://swingpuzzles.com/privacy-policy";

        // --- INBOX BUTTON ---
        const inboxBtn   = document.getElementById("open-inbox-btn");
        const inboxIcon  = document.getElementById("inbox-icon");
        const inboxText  = document.getElementById("inbox-text");

        const providerMap = {
            gmail:   { url: "https://mail.google.com",       label: "Open Gmail",        icon: "icons/gmail.svg" },
            outlook: { url: "https://outlook.live.com/mail", label: "Open Outlook",      icon: "icons/mail.svg" },
            hotmail:{ url: "https://outlook.live.com/mail",  label: "Open Outlook",      icon: "icons/mail.svg" },
            live:    { url: "https://outlook.live.com/mail", label: "Open Outlook",      icon: "icons/mail.svg" },
            yahoo:   { url: "https://mail.yahoo.com",        label: "Open Yahoo Mail",   icon: "icons/mail.svg" },
            centrum: { url: "https://mail.centrum.sk",       label: "Open Centrum Mail", icon: "icons/mail.svg" },
            azet:    { url: "https://mail.centrum.sk",       label: "Open Azet Mail",    icon: "icons/mail.svg" },
            zoznam:  { url: "https://mail.zoznam.sk",        label: "Open Zoznam Mail",  icon: "icons/mail.svg" },
            proton:  { url: "https://mail.proton.me",        label: "Open Proton Mail",  icon: "icons/mail.svg" },
            icloud:  { url: "https://www.icloud.com/mail",   label: "Open iCloud Mail",  icon: "icons/mail.svg" },
            me:      { url: "https://www.icloud.com/mail",   label: "Open iCloud Mail",  icon: "icons/mail.svg" },
            mac:     { url: "https://www.icloud.com/mail",   label: "Open iCloud Mail",  icon: "icons/mail.svg" },
        };

        if (inboxBtn) {
            const info = provider ? providerMap[provider] : null;

            if (info) {
                inboxBtn.href = info.url;
                inboxText.textContent = info.label;
                inboxIcon.style.backgroundImage = `url('${info.icon}')`;

                inboxBtn.style.display = "inline-flex";
                inboxBtn.style.alignItems = "center";
            } else {
                inboxBtn.style.display = "none";
            }
        }
    </script>

    <script src="i18n.js"></script>
</body>
</html>
